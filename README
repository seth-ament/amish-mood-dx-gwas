This repo includes a custom R script used as part of an analysis of the genes at risk loci for mood disorders in the Old Order Amish founder population.

Specifically, the script assesses overlap between the genes at risk loci and protein-protein interactions from the STRING database. 

Methodological details are provided in Humphries et al. 2023 and copied below:

Gene set enrichment analysis. 

Gene-based p-values were computed from GWAS summary statistics using MAGMA [56]. SNPs were annotated to ENSEMBL genes, including a 10 kb window up- and downstream of each gene’s genomic coordinates. Gene p-values were computed using the lowest SNP p-value as the test statistic (snp-wise=top,1), and gene-gene correlations were computed using our imputed OOA genotype matrix. MAGMA gene set enrichment analyses were performed with default parameters. We studied 21 gene sets with prior evidence for association with neuropsychiatry, as described previously [57, 58]. Briefly, these gene sets were derived from the following sources: genes identified through GWAS of MDD [7], BD [8], SCZ [59], and neuroticism [60]; genes identified through genetic association studies of rare variants, including exome and genome sequencing studies of SCZ [61], autism spectrum disorders (ASD) [47], or other developmental disorders [62], as well as genes intolerant to loss-of-function mutations [63]; genes that are differentially expressed in the prefrontal cortex of individuals with BD, SCZ, or ASD [45]; genes that have been identified as targets of the RNA binding proteins FMRP, RBFOX2, RBFOX1/3, and CELF4, of the chromatin remodeling genes CHD8, and of the microRNA miR-137 [58, 64]; genes localized to synapses from SynaptomeDB [65].

Gene interaction networks. 

Human protein-protein interactions were downloaded from the STRING database [66] (https://stringdb-static.org/download/protein.links.detailed.v11.5/9606.protein.links.detailed.v11.5.txt.gz). We defined OOA risk genes as those with a MAGMA gene p-value < 0.01. We used the same 21 neuropsychiatry-related gene sets as in MAGMA gene set enrichment analysis. To assess interactions between established gene sets and OOA risk genes, we counted the number of protein-protein interactions that directly link OOA risk genes to genes in each of the 21 established neuropsychiatry gene sets. We tested whether the number of interactions was greater than expected by chance by two approaches. First, we computed Fisher’s exact tests. Second, we repeatedly permuted the edges of the network, holding each node’s degree constant, and compared the number of OOA-known edges in observed vs. permuted data. Edge permutations were used to confirm results from Fisher’s exact test (n=100 permutations). Odds ratios and p-values from Fisher’s exact test are reported in the manuscript, as they provide a more precise measure of the likelihood.
	To prioritize specific OOA risk genes, we ranked them by their centrality within a gene interaction network centered on known neuropsychiatry risk genes. We defined a set of 684 core neuropsychiatry genes with evidence from at least three independent approaches from our 21 gene sets, as follows: Genes implicated by studies of rare variants; genes implicated by gene expression profiling in prefrontal cortex; genes implicated by gene network analyses; synaptic genes. We excluded genes derived from GWAS, as these genes are potentially non-independent from association signals in our OOA dataset. We extracted all protein-protein interactions from the STRING database for which at least one node was one of these 684 genes. In practice, the large number of interactions in the STRING database means that nearly all genes are represented in this network, but only the subset of their interactions that involve neuropsychiatry-related genes. We used the eigen_centrality() function from the igraph R package [67] to calculate the centrality of each node, including OOA risk genes that have not previously been implicated in neuropsychiatric disorders. We computed ranks for the OOA risk genes, separately, based on eigen-centrality, as well as based on their MAGMA p-values. The final ranking is the median rank from these two metrics. We tested for functional enrichments within the top 250 genes from this analysis using DAVID [68]. 
